<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MyScorer - Archery Scoring App</title>
<link rel="stylesheet" href="style.css" />
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  /* Your original styles (body, container, buttons, inputs etc.) come here, unchanged */

  /* Begin session results screen specific enhancements */

  /* Container and layout for results screen */
  #sessionResultsScreen {
    display: flex;
    flex-direction: column;
    align-items: center;
    height: 100vh;
    min-height: 100vh;
    padding: 10px 15px;
    box-sizing: border-box;
  }

  /* Wrapper to enable independent scrolling of large content */
  .session-results-wrapper {
    max-height: 70vh;
    overflow-y: auto;
    overflow-x: hidden;
    width: 100%;
    max-width: 400px;
    box-sizing: border-box;
    padding-bottom: 24px; /* space below for the button */
  }

  /* Summary text style */
  #sessionResultsSummary {
    color: inherit;
    text-align: center;
    margin-bottom: 15px;
    font-weight: 600;
    font-size: 1rem;
    line-height: 1.4;
  }

  /* Table and canvas styling inside results */
  #sessionResultsTable {
    margin-bottom: 15px;
  }

  #sessionResultsTrendChart,
  #sessionResultsTarget {
    display: block;
    margin: 12px auto;
    max-width: 100%;
    width: 100%;
    height: auto;
    border-radius: 10px;
    box-shadow: 0 0 12px 2px rgba(59, 130, 246, 0.4);
  }

  /* Updated Back To Menu button placement and alignment */
  #backToMenuBtn {
    margin-top: 12px;
    width: 90%;
    max-width: 240px;
    align-self: center;
    border-radius: 12px;
  }

  /* Optional: scrollbar styling for better UX */
  .session-results-wrapper::-webkit-scrollbar {
    width: 8px;
  }
  .session-results-wrapper::-webkit-scrollbar-thumb {
    background-color: rgba(59, 130, 246, 0.5);
    border-radius: 4px;
  }

  /* Responsive adjustments */
  @media (max-width: 450px) {
    .container, #sessionResultsScreen {
      max-width: 96vw;
      padding: 12px 8px;
    }
    #backToMenuBtn {
      width: 95vw;
    }
  }
</style>
</head>
<body>
<div class="container">
  <!-- Login Screen -->
  <div id="loginPage" class="screen active">
    <h1>üèπ My Scorer üèπ</h1>
    <div>
      <label for="username">Name:</label>
      <input type="text" id="username" placeholder="Enter name" />
    </div>
    <div>
      <label for="email">Email:</label>
      <input type="email" id="email" placeholder="Email Address" />
    </div>
    <input type="password" id="password" placeholder="Password" />
    <select id="role">
      <option value="archer">Archer</option>
      <option value="coach">Coach</option>
    </select>
    <button id="signupBtn">Sign Up</button>
    <button id="loginBtn">Login</button>
    <div id="loginMessage" class="message"></div>
  </div>

  <!-- Welcome / Menu Screen -->
  <div id="menuScreen" class="screen">
    <h1>üèπ My Scorer üèπ</h1>
    <p id="greeting" style="text-align:center; font-size:1rem; margin-bottom: 25px;"></p>
    <button id="menuStartBtn">Start Session</button>
    <button id="menuHistoryBtn">My History</button>
    <button id="menuLogoutBtn">Logout</button>
    <button id="menuToggleBtn">Toggle Theme</button>
  </div>

  <!-- Coach Dashboard -->
  <div id="coachDashboard" class="screen">
    <h2>Coach Dashboard</h2>
    <div id="archerListContainer">
      <h3>Archers</h3>
      <ul id="archerList" style="list-style:none; padding-left:0;"></ul>
    </div>
    <div id="archerSessionsContainer" style="margin-top:20px;">
      <h3>Sessions for <span id="selectedArcherName">Select an archer</span></h3>
      <div id="archerSessionList"></div>
    </div>
    <div id="sessionResultContainer" style="margin-top:20px; display:none;">
      <h3>Session Details</h3>
      <div id="sessionResultSummary"></div>
      <div id="sessionResultTable"></div>
      <canvas id="sessionResultChart" width="400" height="200"></canvas>
      <button id="sessionResultCloseBtn">Close</button>
    </div>
    <button id="coachBackBtn" style="margin-top:20px;">Back to Menu</button>
  </div>

  <!-- Session Setup Screen -->
  <div id="setup" class="screen">
    <h2>Session Setup</h2>
    <label for="bowStyle">Bow Style:</label>
    <select id="bowStyle"></select>

    <label for="distance">Distance (m):</label>
    <select id="distance"></select>

    <label for="targetFace">Target Face:</label>
    <select id="targetFace"></select>

    <label for="arrowsPerEnd">Arrows per End:</label>
    <input type="number" id="arrowsPerEnd" value="6" min="1" max="12" />

    <label for="endsCount">Number of Ends:</label>
    <input type="number" id="endsCount" value="6" min="1" max="30" />

    <button id="startSessionBtn">Start Session</button>
    <button id="viewHistoryBtn">View History</button>
    <button id="logoutBtn">Logout</button>
  </div>

  <!-- Scoring Screen -->
  <div id="scoringArea" class="screen">
    <h2>End <span id="currentEnd">1</span></h2>
    <canvas id="target" width="300" height="300"></canvas>
    <p>Tap target to score</p>
    <div id="endScores"></div>
    <div id="endTotal">Total: 0</div>
    <button id="undoBtn">Undo Last Arrow</button>
    <button id="nextEndBtn">Next</button>
    <button id="endSessionBtn" style="display:none;">End Session</button>
  </div>

  <!-- Session Results Screen -->
  <div id="sessionResultsScreen" class="screen">
    <h2>Session Results</h2>
    <div class="session-results-wrapper">
      <div id="sessionResultsSummary"></div>
      <div id="sessionResultsTable"></div>
      <canvas id="sessionResultsTrendChart" width="400" height="200"></canvas>
      <canvas id="sessionResultsTarget" width="300" height="300"></canvas>
    </div>
    <button id="backToMenuBtn">Back to Menu</button>
  </div>

  <!-- History Screen -->
  <div id="historyScreen" class="screen">
    <h2>Session History</h2>
    <div id="historyTable"></div>
    <button id="backToMenuBtn">Back to Menu</button>
  </div>

  <div id="sessionDetailModal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.8); color:#fff; z-index:1000; align-items:center; justify-content:center;">
    <div style="background:#222; padding:20px; border-radius:10px; max-width:90vw; max-height:80vh; overflow-y:auto; position:relative;">
      <button id="closeDetailButton" style="position:absolute; top:10px; right:10px; background:none; border:none; color:#fff; font-size:24px; cursor:pointer;">&times;</button>
      <div id="sessionDetailContent"></div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script type="module" src="script.js"></script>

<script>
  /* Theme toggle logic unchanged */
  const themes = ['', 'light-theme', 'redblack-theme'];
  function getCurrentTheme() { return document.body.className; }
  function getThemeIndex() { return themes.indexOf(getCurrentTheme()); }
  function applyTheme(index) {
    const theme = themes[index] || '';
    document.body.className = theme;
    localStorage.setItem('selectedTheme', theme);
  }
  function toggleTheme() {
    const currentIndex = getThemeIndex();
    const nextIndex = (currentIndex + 1) % themes.length;
    applyTheme(nextIndex);
  }
  document.addEventListener('DOMContentLoaded', () => {
    const savedTheme = localStorage.getItem('selectedTheme') || '';
    if (themes.includes(savedTheme)) document.body.className = savedTheme;
    const toggleBtn = document.getElementById('menuToggleBtn');
    if (toggleBtn) toggleBtn.addEventListener('click', toggleTheme);
  });
</script>
</body>
</html>

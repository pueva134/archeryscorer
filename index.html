<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MyScorer - Archery Scoring App</title>
<link rel="stylesheet" href="style.css" />
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  /* Basic styles adapted from your report to preserve original UI theme */
  body {
    background-color: #181f2a;
    color: #fff;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0; padding: 0;
  }
  .container {
    max-width: 400px;
    margin: 40px auto;
    padding: 15px;
  }
  .screen {
    display: none;
  }
  .screen.active {
    display: block;
  }
  h1, h2, h3 {
    text-align: center;
  }
  input[type="text"], input[type="email"], input[type="password"], select, input[type="number"], textarea {
    width: 100%;
    padding: 10px;
    margin: 8px 0 15px;
    border-radius: 8px;
    border: none;
    font-size: 1rem;
  }
  button {
    width: 100%;
    padding: 12px 0;
    margin: 8px 0;
    border-radius: 10px;
    border: none;
    background: linear-gradient(90deg, #3984f7, #52c3ff);
    color: #fff;
    font-weight: 700;
    cursor: pointer;
    font-size: 1.1rem;
    transition: background 0.3s ease;
  }
  button:hover {
    background: linear-gradient(90deg, #1a62d1, #3e9bf7);
  }
  #target {
    display: block;
    margin: 0 auto 15px;
    background-color: #222;
    border-radius: 50%;
    box-shadow: 0 0 12px 3px rgba(255,255,255,0.1);
  }
  table {
    width: 100%;
    border-collapse: collapse;
    background-color: #232c42;
    border-radius: 10px;
    overflow: hidden;
  }
  th, td {
    padding: 10px;
    border: 1px solid #2a344b;
    text-align: center;
  }
  th {
    background-color: #394a79;
  }
  .message {
    color: #e74c3c;
    text-align: center;
    margin-bottom: 15px;
    font-weight: 600;
  }

  /* ===== Light Theme ===== */
  body.light-theme {
    background: linear-gradient(135deg, #f5f8fa, #dbeafe);
    color: #222;
  }
  body.light-theme .container {
    background: rgba(245, 250, 255, 0.97);
    box-shadow: 0 4px 28px 0 rgba(59, 130, 246, 0.12);
    color: #222;
  }
  body.light-theme input[type="text"],
  body.light-theme input[type="email"],
  body.light-theme input[type="password"],
  body.light-theme select,
  body.light-theme input[type="number"],
  body.light-theme textarea {
    background: #fafafa;
    color: #222;
    border: 1px solid #ccc;
  }
  body.light-theme button {
    background: linear-gradient(90deg, #fbbf24, #f59e42);
    color: #222;
  }
  body.light-theme button:hover {
    background: linear-gradient(90deg, #d97706, #b45309);
  }
  body.light-theme table {
    background-color: #fff;
    color: #222;
  }
  body.light-theme th {
    background-color: #f9a825;
    color: #222;
  }
  body.light-theme td {
    border-color: #ddd;
  }
  body.light-theme .message {
    color: #b91c1c;
  }

  /* ===== Red/Black Dark Theme ===== */
  body.redblack-theme {
    background-color: #100e0e;
    color: #f87171;
  }
  body.redblack-theme .container {
    background: rgba(22, 22, 25, 0.97);
    border-radius: 20px;
    box-shadow: 0 6px 32px 0 rgba(239, 68, 68, 0.18);
    color: #f87171;
  }
  body.redblack-theme input[type="text"],
  body.redblack-theme input[type="email"],
  body.redblack-theme input[type="password"],
  body.redblack-theme select,
  body.redblack-theme input[type="number"],
  body.redblack-theme textarea {
    background: #1b1717;
    color: #f87171;
    border: 1px solid #9f1239;
  }
  body.redblack-theme button {
    border-radius: 10px;
    border: none;
    font-weight: 700;
    font-size: 1.1rem;
    cursor: pointer;
    padding: 12px 0;
    margin: 8px 0;
    width: 100%;
  }
  body.redblack-theme button:nth-child(3n + 1) {
    background: linear-gradient(90deg, #ef4444, #111112);
    color: #fff;
    box-shadow: 0 2px 8px rgba(239, 68, 68, 0.22);
  }
  body.redblack-theme button:nth-child(3n + 1):hover {
    background: linear-gradient(90deg, #991b1b, #000000);
  }
  body.redblack-theme button:nth-child(3n + 2) {
    background: linear-gradient(90deg, #991b1b, #222223);
    color: #fff;
    box-shadow: 0 2px 8px rgba(239, 68, 68, 0.16);
  }
  body.redblack-theme button:nth-child(3n + 2):hover {
    background: linear-gradient(90deg, #b91c1c, #3c1919);
  }
  body.redblack-theme button:nth-child(3n + 3) {
    background: linear-gradient(90deg, #1a1a1f, #391217);
    color: #fff;
    box-shadow: 0 2px 8px rgba(55, 20, 20, 0.07);
  }
  body.redblack-theme button:nth-child(3n + 3):hover {
    background: linear-gradient(90deg, #000000, #6b1313);
  }
</style>
</head>
<body>

<div class="container">
  <!-- Login Screen -->
  <div id="loginPage" class="screen active">
    <h1>üèπ My Scorer üèπ</h1>
    <div>
      <label for="username">Name:</label>
      <input type="text" id="username" placeholder="Enter name" />
    </div>
    <div>
      <label for="email">Email:</label>
      <input type="email" id="email" placeholder="Email Address" />
    </div>
    <input type="password" id="password" placeholder="Password" />
    <select id="role">
      <option value="archer">Archer</option>
      <option value="coach">Coach</option>
    </select>
    <button id="signupBtn">Sign Up</button>
    <button id="loginBtn">Login</button>
    <div id="loginMessage" class="message"></div>
  </div>

  <!-- Welcome / Menu Screen -->
  <div id="menuScreen" class="screen">
    <h1>üèπ My Scorer üèπ</h1>
    <p id="greeting" style="text-align:center; font-size:1rem; margin-bottom: 25px;"></p>
    <button id="menuStartBtn">Start Session</button>
    <button id="menuHistoryBtn">My History</button>
    <button id="menuLogoutBtn">Logout</button>
    <button id="menuToggleBtn">Toggle Theme</button>
  </div>

  <!-- Coach Dashboard -->
  <div id="coachDashboard" class="screen">
    <h2>Coach Dashboard</h2>
    <div id="archerListContainer">
      <h3>Archers</h3>
      <ul id="archerList" style="list-style:none; padding-left:0;"></ul>
    </div>
    <div id="archerSessionsContainer" style="margin-top:20px;">
      <h3>Sessions for <span id="selectedArcherName">Select an archer</span></h3>
      <div id="archerSessionList"></div>
    </div>
    <div id="sessionResultContainer" style="margin-top:20px; display:none;">
      <h3>Session Details</h3>
      <div id="sessionResultSummary"></div>
      <div id="sessionResultTable"></div>
      <canvas id="sessionResultChart" width="400" height="200"></canvas>
      <button id="sessionResultCloseBtn">Close</button>
    </div>
    <button id="coachBackBtn" style="margin-top:20px;">Back to Menu</button>
  </div>

  <!-- Session Setup Screen -->
  <div id="setup" class="screen">
    <h2>Session Setup</h2>
    <label for="bowStyle">Bow Style:</label>
    <select id="bowStyle"></select>

    <label for="distance">Distance (m):</label>
    <select id="distance"></select>

    <label for="targetFace">Target Face:</label>
    <select id="targetFace"></select>

    <label for="arrowsPerEnd">Arrows per End:</label>
    <input type="number" id="arrowsPerEnd" value="6" min="1" max="12" />

    <label for="endsCount">Number of Ends:</label>
    <input type="number" id="endsCount" value="6" min="1" max="30" />

    <button id="startSessionBtn">Start Session</button>
    <button id="viewHistoryBtn">View History</button>
    <button id="logoutBtn">Logout</button>
  </div>

  <!-- Scoring Screen -->
  <div id="scoringArea" class="screen">
    <h2>End <span id="currentEnd">1</span></h2>
    <canvas id="target" width="300" height="300"></canvas>
    <p>Tap target to score</p>
    <div id="endScores"></div>
    <div id="endTotal">Total: 0</div>
    <button id="undoBtn">Undo Last Arrow</button>
    <button id="nextEndBtn">Next</button>
    <button id="endSessionBtn" style="display:none;">End Session</button>
  </div>

<!-- Session Results Screen -->
<div id="sessionResultsScreen" class="screen">
  <h2>Session Results</h2>
  
  <div class="session-results-wrapper">
    <div id="sessionResultsSummary"></div>
    <div id="sessionResultsTable"></div>
    <canvas id="sessionResultsTrend" width="600" height="300"></canvas>
    <canvas id="sessionResultsTarget" width="300" height="300"></canvas>
  </div>
  
  <button id="backToMenuBtn">Back to Menu</button>
</div>

  <!-- History Screen -->
  <div id="historyScreen" class="screen">
    <h2>Session History</h2>
    <div id="historyTable"></div>
    <button id="backToMenuBtn">Back to Menu</button>
  </div>

  <div id="sessionDetailModal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.8); color:#fff; z-index:1000; align-items:center; justify-content:center;">
    <div style="background:#222; padding:20px; border-radius:10px; max-width:90vw; max-height:80vh; overflow-y:auto; position:relative;">
      <button id="closeDetailButton" style="position:absolute; top:10px; right:10px; background:none; border:none; color:#fff; font-size:24px; cursor:pointer;">&times;</button>
      <div id="sessionDetailContent"></div>
    </div>
  </div>
</div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script type="module" src="script.js"></script>

<script>
  // Theme toggle implementation

  const themes = ['', 'light-theme', 'redblack-theme']; // '' = original dark

  function getCurrentTheme() {
    return document.body.className;
  }

  function getThemeIndex() {
    return themes.indexOf(getCurrentTheme());
  }

  function applyTheme(index) {
    const theme = themes[index] || '';
    document.body.className = theme;
    localStorage.setItem('selectedTheme', theme);
  }

  function toggleTheme() {
    const currentIndex = getThemeIndex();
    const nextIndex = (currentIndex + 1) % themes.length;
    applyTheme(nextIndex);
  }

  // On page load, apply saved theme if any
  document.addEventListener('DOMContentLoaded', () => {
    const savedTheme = localStorage.getItem('selectedTheme') || '';
    if (themes.includes(savedTheme)) {
      document.body.className = savedTheme;
    }
    // Attach event to toggle button
    const toggleBtn = document.getElementById('menuToggleBtn');
    if (toggleBtn) {
      toggleBtn.addEventListener('click', toggleTheme);
    }
  });
</script>

</body>
</html>
